<div class="container">
  <h2>Gestion des Produits</h2>

  <!-- Formulaire d'ajout -->
  @if (!isEditing) {
    <div class="card">
      <h3>Ajouter un nouveau produit</h3>
      <form (ngSubmit)="createProduct()">
        <div class="form-group">
          <input type="text" [(ngModel)]="newProduct.name" name="name" placeholder="Nom du produit" required>
        </div>
        <div class="form-group">
          <textarea [(ngModel)]="newProduct.description" name="description" placeholder="Description" required></textarea>
        </div>
        <div class="form-group">
          <input type="number" [(ngModel)]="newProduct.price" name="price" placeholder="Prix" min="0" step="0.01" required>
        </div>
        <div class="form-group">
          <select [(ngModel)]="newProduct.category" name="category" required>
            <option value="">Sélectionnez une catégorie</option>
            @for (cat of categories; track cat) {
              <option [value]="cat">{{ cat }}</option>
            }
          </select>
        </div>
        <div class="form-group">
          <input type="number" [(ngModel)]="newProduct.stock" name="stock" placeholder="Nombre d'articles en stock" min="0" required>
        </div>
        <div class="form-group">
          <input type="text" [(ngModel)]="newProduct.imageUrl" name="imageUrl" placeholder="URL de l'image">
        </div>
        <button type="submit" class="btn btn-primary">Ajouter le produit</button>
      </form>
    </div>
  }

  <!-- Formulaire d'édition -->
  @if (isEditing && selectedProduct) {
    <div class="card">
      <h3>Modifier le produit</h3>
      <form (ngSubmit)="updateProduct()">
        <div class="form-group">
          <input type="text" [(ngModel)]="selectedProduct.name" name="editName" placeholder="Nom du produit" required>
        </div>
        <div class="form-group">
          <textarea [(ngModel)]="selectedProduct.description" name="editDescription" placeholder="Description" required></textarea>
        </div>
        <div class="form-group">
          <input type="number" [(ngModel)]="selectedProduct.price" name="editPrice" placeholder="Prix" min="0" step="0.01" required>
        </div>
        <div class="form-group">
          <select [(ngModel)]="selectedProduct.category" name="editCategory" required>
            @for (cat of categories; track cat) {
              <option [value]="cat">{{ cat }}</option>
            }
          </select>
        </div>
        <div class="form-group">
          <input type="number" [(ngModel)]="selectedProduct.stock" name="editstock" placeholder="Nombre d'articles en stock" min="0" required>
        </div>
        <div class="form-group">
          <input type="text" [(ngModel)]="selectedProduct.imageUrl" name="editImageUrl" placeholder="URL de l'image">
        </div>
        <div class="form-actions">
          <button type="submit" class="btn btn-success">Mettre à jour</button>
          <button type="button" (click)="cancelEdit()" class="btn btn-secondary">Annuler</button>
        </div>
      </form>
    </div>
  }

  <!-- Liste des produits -->
  <div class="card">
    <h3>Liste des produits ({{ products.length }})</h3>
    <div class="table-container">
      <table>
        <thead>
          <tr>
            <th>Nom</th>
            <th>Description</th>
            <th>Prix</th>
            <th>Catégorie</th>
            <th>Stock</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          @for (product of products; track product) {
            <tr>
              <td>{{ product.name }}</td>
              <td>{{ product.description }}</td>
              <td>{{ product.price | currency:'EUR' }}</td>
              <td>{{ product.category }}</td>
              <td [class.low-stock]="product.stock < 10">{{ product.stock }}</td>
              <td class="actions">
                <button (click)="editProduct(product)" class="btn btn-warning">Modifier</button>
                <button (click)="deleteProduct(product)" class="btn btn-danger">Supprimer</button>
              </td>
            </tr>
          }
        </tbody>
      </table>
    </div>
  </div>
</div>